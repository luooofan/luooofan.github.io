---
title: C语言中的几个关键字
date: 2021-03-08 11:31:11
categories: ProgrammingLanguage
tags: [C/C++, Note]
description: C语言中有四种对变量的存储类型说明关键字，auto，static，extern，register。
keywords: 
cover: false
---
# C语言中的几个关键字



## 变量的存储类型

在C语言中变量和函数有**数据类型**和**存储类型**两个属性，因此变量定义的一般形式为：`存储类型 数据类型 变量名`

变量名要求是标识符，不能是关键字

变量有作用域(scope)和生存期(lifetime)的概念，作用域是指可以存取变量的代码范围，生存期是指可以存取变量的时间范围。生存期只是和变量存储的位置相关。变量的存储类别，可以分为静态存储方式和动态存储方式。

对变量的存储类型说明有以下四种：

1. 自动变量（auto）
2. 静态变量（static）
3. 外部变量（extern）
4. 寄存器变量（register）

这四个都是C语言的关键字，其中，auto和register是动态存储方式，static和extern是静态存储方式

程序的存储空间主要分为三个部分：

1. 代码段(text)
2. 静态存储段(rodata,data,bss)
3. 动态存储段(heap,stack)




## 自动变量

**自动变量，具有自动存储期、块作用域且无链接。默认情况下，声明在块或函数头中的任何变量都属于自动存储类别。一般情况下，不作专门说明的局部变量，均是自动变量**

关键字`auto`是存储类别说明符（storage-class specifier）。auto关键字在C++中的用法完全不同，如果编写C/C++兼容的程序，最好不要使用auto作为存储类别说明符

块作用域和无链接意味着只有在变量定义所在的块中才能通过变量名访问该变量（当然，参数用于传递变量的值和地址给另一个函数，但是这是间接的方法）

变量具有自动存储期意味着，程序在进入该变量声明所在的块时变量存在，程序在退出该块时变量消失。原来该变量占用的内存位置现在可做他用。也即动态存储方式，存储在堆栈中

自动变量不自动初始化，除非显示初始化，否则直接使用内存地址中的值


## 静态变量

static修饰全局变量或函数，限制该变量的作用域为本文件

static修饰局部变量，将变量存储在程序的静态存储区而非栈上空间，只执行初始化一次，延长了局部变量的生命周期，直到程序运行结束以后才释放

## 外部变量

extern是C语言中的一个关键字，一般用在变量名前或函数名前，作用是用来说明“此变量/函数是在别处定义的，要在此处引用”

外部变量保存在静态存储区内，在程序运行期间分配固定的存储单元，其生存期是整个程序的运行期，没有显式初始化的外部变量由编译程序自动初始化为0（extern说明符来扩展全局变量的作用域，可以将全局变量的作用域扩展到其他文件，但不能限制全局变量的作用域）

在C语言中，变量和函数的声明可以有多次，但定义只能有一次，首先要弄明白怎么算定义怎么算声明

```c
int e;           // define
extern int a;    // declare
int a=1;         // define
extern int d=1;  // define

int main()
{
    int c;       // define
    extern int a;// declare
    int b=1;     // define 
    return 0;
}
```

对于函数来说，声明和定义有明显的区别，extern是缺省的关键字，可忽略不写

**tip**：头文件中只放声明，不放定义，否则当头文件被多个文件include时，会产生重复定义的链接错误


## 寄存器变量

关于寄存器变量有以下事项需要注意：
1) 为寄存器变量分配寄存器是动态完成的，因此，只有局部变量和形式参数才能定义为寄存器变量。

2) 局部静态变量不能定义为寄存器变量，因为一个变量只能声明为一种存储类别。

3) 寄存器的长度一般和机器的字长一致，所以，只有较短的类型如int、char、short等才适合定义为寄存器变量，诸如double等较大的类型，不推荐将其定义为寄存器类型。

4) CPU的寄存器数目有限，因此，即使定义了寄存器变量，编译器可能并不真正为其分配寄存器，而是将其当做普通的auto变量来对待，为其分配栈内存。当然，有些优秀的编译器，能自动识别使用频繁的变量，如循环控制变量等，在有可用的寄存器时，即使没有使用 register 关键字，也自动为其分配寄存器，无须由程序员来指定。

## 关于const关键字

`const int a = 10;` 全局变量a的本质是只读变量

C语言的const修饰全局变量默认是extern外部链接的，只读的全局变量，内存放在文字常量区，内存空间只读

其他文件可以通过`extern const int a;`来使用a变量，但不能修改

但如果const修饰局部变量的话，不能通过变量名进行赋值来更改，变量名只读，内存空间栈区可读可写，可以通过其地址间接地修改空间内容

## 参考

- [extern的使用详解（多文件编程）——C语言](https://www.cnblogs.com/lanhaicode/p/10633125.html)
- [带你了解C语言自动变量的几种类型-auto变量](https://www.w3cschool.cn/article/a1bf1f2b9cf335.html)
- [C/C++中static的用法全局变量与局部变量](https://www.cnblogs.com/33debug/p/7223869.html)
- [C/C++ 中的static关键字](https://zhuanlan.zhihu.com/p/37439983)
- [C语言register变量](http://c.biancheng.net/cpp/html/2864.html)
- [细谈c++的const](https://zhuanlan.zhihu.com/p/128581278)

